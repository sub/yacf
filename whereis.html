<!DOCTYPE html>
<html>
  <head>
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <link rel="stylesheet" href="jquery.mobile-1.0a1.min.css" />
    <script src="scripts/phonegap.js"></script>
    <script src="scripts/jquery-1.4.3.min.js"></script>
    <script src="scripts/jquery.mobile-1.0a1.min.js"></script>
    <script type="text/javascript"
	    src="http://maps.google.com/maps/api/js?sensor=true">
    </script>
    <style type="text/css">
      #map_canvas { height: 40% }
    </style>
    
    <script type="text/javascript">
    function loader() {
	var state = document.readyState;

	if (typeof(localStorage) == 'undefined' ) {
	    alert('Upgrade your browser as it does not support HTML5 localStorage.');
	} 

	if (state == 'loaded' || state == 'complete') {
            // getLocation();
	    latitude = localStorage.getItem("latitude");
	    alert(latitude);
	} else {
            if (navigator.userAgent.indexOf('Browzr') > -1) {
		setTimeout(geoLocation, 250);
            } else {
		document.addEventListener('deviceready',geoLocation,false);
	    }
	}
    }

    var getLocation = function() {
	var suc = function(p) {
	    initializeMap(p);
	};
	var fail = function() {
	    alert("NOT ABLE TO GET THE CURRENT POSITION");
	};
//	navigator.geolocation.getCurrentPosition(suc,fail);
    }

    function initializeMap(p) {
        latitude = localStorage.getItem("latitude");
	alert("should go to " + latitude);

	var latlng = new google.maps.LatLng(p.coords.latitude, p.coords.longitude);
	var myOptions = {
	    zoom: 8,
	    center: latlng,
	           mapTypeId: google.maps.MapTypeId.ROADMAP
	};
	var map = new google.maps.Map(document.getElementById("map_canvas"),
            myOptions);
    }

</script>
    
  </head>
    <body onload="loader()">
    
      <div data-role="page" data-theme="b" id="whereis">
	<div data-role="header">
	  <h1>whereis? - position</h1>
	</div>
	
	<div data-role="content" class="content" align="center">
	  
        </div>

	<!-- <div data-role="content" class="content"> -->
	<!--   <div id="map_canvas" style="width:100%; height:100%; position:absolute"></div> -->
	<!-- </div> -->
	
	<div data-role="footer">
	  <h4>@fitzkarraldo</h4>
	</div>
      </div>
      
    </body>

</html>
